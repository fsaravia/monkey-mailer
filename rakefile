root = ::File.dirname(__FILE__)
require ::File.join(root, 'lib', 'postman')

namespace :db do
  task :setup do
    require_relative 'lib/postman/loader'
    models = DataMapper::Model.descendants
    Postman.configuration.databases.each_key do |database|
      models.each do |model|
        model.auto_migrate!(database.to_sym)
      end
      puts "Database #{database} has been setup"
    end
  end
end